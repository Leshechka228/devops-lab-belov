#!/bin/bash

echo "üß™ –ó–∞–ø—É—Å–∫ CI —Ç–µ—Å—Ç–æ–≤ –¥–ª—è DevOps –ø—Ä–æ–µ–∫—Ç–∞ - belov"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞
echo "üìÅ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞..."
required_files=("index.html" "nginx.conf" "deploy.sh" "README.md")
for file in "${required_files[@]}"; do
    if [ -f "$file" ]; then
        echo "‚úÖ $file —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
    else
        echo "‚ùå $file –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
        exit 1
    fi
done

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –≤ index.html –µ—Å—Ç—å —Ä–∞–∫–µ—Ç–∞
echo "üöÄ –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ä–∞–∫–µ—Ç—ã –≤ index.html..."
if grep -q "üöÄ" index.html; then
    echo "‚úÖ –†–∞–∫–µ—Ç–∞ –Ω–∞–π–¥–µ–Ω–∞ –Ω–∞ —Å–∞–π—Ç–µ"
else
    echo "‚ùå –†–∞–∫–µ—Ç–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç - —Å–∞–π—Ç –Ω–µ –≥–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É!"
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –≤ index.html –µ—Å—Ç—å –∏–º—è —Å—Ç—É–¥–µ–Ω—Ç–∞
echo "üë§ –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∏–º–µ–Ω–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞..."
if grep -q "belov" index.html; then
    echo "‚úÖ –ò–º—è —Å—Ç—É–¥–µ–Ω—Ç–∞ belov –Ω–∞–π–¥–µ–Ω–æ"
else
    echo "‚ùå –ò–º—è —Å—Ç—É–¥–µ–Ω—Ç–∞ belov –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
echo "üåê –ü—Ä–æ–≤–µ—Ä—è–µ–º nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é..."
if grep -q "listen 8181" nginx.conf; then
    echo "‚úÖ nginx —Å–ª—É—à–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 8181"
else
    echo "‚ùå nginx –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –ø–æ—Ä—Ç 8181"
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–∫—Ä–∏–ø—Ç—ã –Ω–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
echo "üîß –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–∏–Ω—Ç–∞–∫—Å–∏—Å shell —Å–∫—Ä–∏–ø—Ç–æ–≤..."
scripts=("deploy.sh" "test.sh" "check-system.sh")
for script in "${scripts[@]}"; do
    if [ -f "$script" ]; then
        if bash -n "$script"; then
            echo "‚úÖ $script - —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π"
        else
            echo "‚ùå $script - –æ—à–∏–±–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞"
            exit 1
        fi
    fi
done

echo "üéâ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ! –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é."
